# HR & User Management рж╕ржВржХрзНрж╖рж┐ржкрзНржд рж╕ржВрж╢рзЛржзржи рж░рж┐ржкрзЛрж░рзНржЯ

**рж╕ржорзНржкржирзНржи**: рзирзжрзирзм-рзжрзз-рзйрзж

---

## рж╕ржВрж╢рзЛржзрж┐ржд рж╕ржорж╕рзНржпрж╛

### ЁЯФ┤ ржкрзНрж░ржзрж╛ржи рж╕ржорж╕рзНржпрж╛ (рж╕ржорж╛ржзрж╛ржи ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ)

| рж╕ржорж╕рзНржпрж╛ | рж╕ржорж╛ржзрж╛ржи | ржлрж╛ржЗрж▓ |
|--------|--------|-------|
| **ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА рждрзИрж░рж┐ тЖТ HR рж░рзЗржХрж░рзНржб ржирзЗржЗ** | рж╕рзНржмржпрж╝ржВржХрзНрж░рж┐ржпрж╝ рж╕рж┐ржЩрзНржХ ржпрзЛржЧ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ | `convex/userManagement.ts` |
| **ржХрж░рзНржоржЪрж╛рж░рзА рждрзИрж░рж┐ тЖТ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржЕрзНржпрж╛ржХрж╛ржЙржирзНржЯ ржирзЗржЗ** | рж╕рзНржмржпрж╝ржВржХрзНрж░рж┐ржпрж╝ рж╕рж┐ржЩрзНржХ ржпрзЛржЧ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ | `convex/hr.ts` |
| **ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржЖржкржбрзЗржЯ тЖТ HR рж╕рж┐ржЩрзНржХ рж╣ржпрж╝ ржирж╛** | ржмрж┐ржбрж┐рж░рзЗржХрж╢ржирж╛рж▓ рж╕рж┐ржЩрзНржХ ржпрзЛржЧ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ | `convex/userManagement.ts` |
| **ржХрж░рзНржоржЪрж╛рж░рзА ржЖржкржбрзЗржЯ тЖТ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА рж╕рж┐ржЩрзНржХ рж╣ржпрж╝ ржирж╛** | ржмрж┐ржбрж┐рж░рзЗржХрж╢ржирж╛рж▓ рж╕рж┐ржЩрзНржХ ржпрзЛржЧ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ | `convex/hr.ts` |
| **ржмрзЛржирж╛рж╕ Payroll ржП ржпрзБржХрзНржд рж╣ржпрж╝ ржирж╛** | ржЕржирзБржорзЛржжрж┐ржд ржмрзЛржирж╛рж╕ ржЕржирзНрждрж░рзНржнрзБржХрзНржд ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ | `convex/hr.ts` |

---

## ржХрзЛржб ржкрж░рж┐ржмрж░рзНрждржирзЗрж░ рж╕рж╛рж░рж╛ржВрж╢

### рзз. User Management - createUser
```typescript
// ржирждрзБржи: HR рж░рзЗржХрж░рзНржб рж╕рж┐ржЩрзНржХ
if (args.branchId && args.branchName) {
  await ctx.db.insert("hrEmployees", { ... });
}
```

### 2. User Management - updateUser
```typescript
// ржирждрзБржи: HR ржЖржкржбрзЗржЯ рж╕рж┐ржЩрзНржХ
const hrEmployee = await ctx.db.query("hrEmployees")...
if (hrEmployee) {
  await ctx.db.patch(hrEmployee._id, hrUpdates);
}
```

### 3. HR - createEmployee
```typescript
// ржирждрзБржи: ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржЕрзНржпрж╛ржХрж╛ржЙржирзНржЯ рж╕рж┐ржЩрзНржХ
if (!existingUser) {
  await ctx.db.insert("userManagement", { ... });
}
```

### 4. HR - updateEmployee
```typescript
// ржирждрзБржи: ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржЖржкржбрзЗржЯ рж╕рж┐ржЩрзНржХ
const user = await ctx.db.query("userManagement")...
if (user) {
  await ctx.db.patch(user._id, userUpdates);
}
```

### 5. HR - generatePayroll
```typescript
// ржирждрзБржи: ржмрзЛржирж╛рж╕ ржПржмржВ ржЗржирж╕рзЗржиржЯрж┐ржн ржХрзНржпрж╛рж▓ржХрзБрж▓рзЗрж╢ржи
const bonusRecords = await ctx.db.query("hrBonusIncentive")...
const bonusAmount = bonusRecords.reduce(...);
```

---

## ржкрзНрж░ржнрж╛ржм ржПржмржВ рж╕рзБржмрж┐ржзрж╛

тЬЕ **ржбрзЗржЯрж╛ рж╕рж╛ржоржЮрзНржЬрж╕рзНржп**
- ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржПржмржВ ржХрж░рзНржоржЪрж╛рж░рзА рж░рзЗржХрж░рзНржб рж╕рж░рзНржмржжрж╛ рж╕рж┐ржЩрзНржХ ржерж╛ржХрзЗ
- ржХрзЛржи ржмрж┐ржжрзНржзржорж╛ржи ржбрзЗржЯрж╛ ржирзЗржЗ
- рж╕рж┐ржЩрзНржЧрзЗрж▓ рж╕рзЛрж░рзНрж╕ ржЕржл ржЯрзНрж░рзБрже ржирзАрждрж┐

тЬЕ **рж╕рзНржмржпрж╝ржВржХрзНрж░рж┐ржпрж╝ржХрж░ржг**
- ржХрж░рзНржоржЪрж╛рж░рзА рждрзИрж░рж┐ тЖТ рж╕рзНржмржпрж╝ржВржХрзНрж░рж┐ржпрж╝ржнрж╛ржмрзЗ рж▓ржЧржЗржи ржЕрзНржпрж╛ржХрж╛ржЙржирзНржЯ
- ржирж╛ржо ржкрж░рж┐ржмрж░рзНрждржи тЖТ ржЙржнржпрж╝ ржЬрж╛ржпрж╝ржЧрж╛ржпрж╝ ржЖржкржбрзЗржЯ
- ржмрзЛржирж╛рж╕ ржЕржирзБржорзЛржжржи тЖТ рж╕рзНржмржпрж╝ржВржХрзНрж░рж┐ржпрж╝ржнрж╛ржмрзЗ Payroll ржП ржпрзБржХрзНржд

тЬЕ **ржжржХрзНрж╖рждрж╛ ржмрзГржжрзНржзрж┐**
- ржбрзБржкрзНрж▓рж┐ржХрзЗржЯ ржПржирзНржЯрзНрж░рж┐ ржжрзВрж░ рж╣ржпрж╝рзЗржЫрзЗ
- ржорзНржпрж╛ржирзБржпрж╝рж╛рж▓ рж╕рж┐ржЩрзНржХ ржХрж╛ржЬ ржжрзВрж░ рж╣ржпрж╝рзЗржЫрзЗ
- рж╕ржоржпрж╝ рж╕рж╛рж╢рзНрж░ржпрж╝ ржПржмржВ рждрзНрж░рзБржЯрж┐ рж╣рзНрж░рж╛рж╕

---

## ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ

тЬЕ **ржХржорзНржкрж╛ржЗрж▓рзЗрж╢ржи**
- ржХрзЛржи TypeScript ржПрж░рж░ ржирзЗржЗ
- рж╕ржорж╕рзНржд ржЗржорзНржкрзЛрж░рзНржЯ рж╕ржарж┐ржХ
- рж╕рзНржХрж┐ржорж╛ ржпрж╛ржЪрж╛ржЗржХрж░ржг ржкрж╛рж╕

тП│ **ржлрж╛ржВрж╢ржирж╛рж▓ ржЯрзЗрж╕рзНржЯрж┐ржВ ржкрзНрж░ржпрж╝рзЛржЬржи**
- User creation sync
- Employee creation sync
- Update synchronization
- Payroll calculation
- Bonus inclusion

---

## ржкрж░ржмрж░рзНрждрзА ржкржжржХрзНрж╖рзЗржк

1. **рж╕рзНржмржпрж╝ржВржХрзНрж░рж┐ржпрж╝ ржЯрзЗрж╕рзНржЯрж┐ржВ**
   - ржкрзНрж░рждрж┐ржЯрж┐ ржкрж░рж┐рж╕рзНржерж┐рждрж┐ ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рзБржи
   - HR_TESTING_GUIDE.md ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржи

2. **ржбрзЗржЯрж╛ ржпрж╛ржЪрж╛ржЗржХрж░ржг**
   - ржмрж┐ржжрзНржпржорж╛ржи рж░рзЗржХрж░рзНржб ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рзБржи
   - ржбрзБржкрзНрж▓рж┐ржХрзЗржЯ ржЦрзБржБржЬрзЗ ржкрж╛ржи ржПржмржВ ржкрж░рж┐рж╖рзНржХрж╛рж░ ржХрж░рзБржи

3. **рж░рзЛрж▓ржЖржЙржЯ ржкрж░рж┐ржХрж▓рзНржкржирж╛**
   - ржкрзНрж░рзЛржбрж╛ржХрж╢ржи ржкрзВрж░рзНржм ржкрж░рзАржХрзНрж╖рж╛
   - ржирж┐рж░рзАржХрзНрж╖рж╛ ржЯрзНрж░рзЗржЗрж▓ рж╕рзЗржЯржЖржк
   - ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржкрзНрж░рж╢рж┐ржХрзНрж╖ржг

---

## ржлрж╛ржЗрж▓ ржкрж░рж┐ржмрж░рзНрждржи рж╕рж╛рж░рж╛ржВрж╢

| ржлрж╛ржЗрж▓ | ржкрж░рж┐ржмрж░рзНрждржи | рж▓рж╛ржЗржи |
|------|----------|-------|
| `convex/userManagement.ts` | HR рж╕рж┐ржЩрзНржХ ржпрзЛржЧ ржХрж░рж╛ | 207-265, 308-338 |
| `convex/hr.ts` | ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржПржмржВ ржмрзЛржирж╛рж╕ рж╕рж┐ржЩрзНржХ | 57-160, 178-214, 630-660 |

---

## ржбржХрзБржорзЗржирзНржЯрзЗрж╢ржи рждрзИрж░рж┐ ржХрж░рж╛

ЁЯУД `HR_PAYROLL_AUDIT.md` - ржмрж┐рж╕рзНрждрж╛рж░рж┐ржд ржЕржбрж┐ржЯ рж░рж┐ржкрзЛрж░рзНржЯ
ЁЯУД `HR_PAYROLL_SYNC_FIXES.md` - рж╕рж┐ржЩрзНржХ рж╕ржВрж╢рзЛржзржирзЗрж░ ржмрж┐ржмрж░ржг
ЁЯУД `HR_TESTING_GUIDE.md` - ржкрж░рзАржХрзНрж╖рж╛рж░ ржкржжрзНржзрждрж┐ ржПржмржВ ржЪрзЗржХрж▓рж┐рж╕рзНржЯ

---

## рж╕рзНржЯрзНржпрж╛ржЯрж╛рж╕: тЬЕ рж╕ржорзНржкржирзНржи

рж╕ржорж╕рзНржд HR ржПржмржВ User Management рж╕рж┐ржЩрзНржХ рж╕ржорж╕рзНржпрж╛ рж╕ржорж╛ржзрж╛ржи ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗред
рж╕рж┐рж╕рзНржЯрзЗржо ржПржЦржи рж╕ржорзНржкрзВрж░рзНржгржнрж╛ржмрзЗ ржПржХрзАржнрзВржд ржПржмржВ рж╕рзНржмржпрж╝ржВржХрзНрж░рж┐ржпрж╝ред

