# Undo Sale Feature - ржЗржирзНржЯрж╛рж░рзЗржХрзНржЯрж┐ржн ржЯрзЗрж╕рзНржЯрж┐ржВ ржЪрзЗржХрж▓рж┐рж╕рзНржЯ

**рждрж╛рж░рж┐ржЦ:** ____________  
**ржЯрзЗрж╕рзНржЯрж╛рж░:** ____________  
**рж╕ржоржпрж╝:** ____________  

---

## ЁЯУЛ ржкрзНрж░рж┐-ржЯрзЗрж╕рзНржЯ ржЪрзЗржХрж▓рж┐рж╕рзНржЯ

### рж╕рж┐рж╕рзНржЯрзЗржо ржкрзНрж░рж╕рзНрждрзБрждрж┐

- [ ] Convex backend running (npm run dev:backend)
- [ ] Frontend running (npm run dev:frontend) 
- [ ] ржбрж╛ржЯрж╛ржмрзЗрж╕ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ржпрзЛржЧрзНржп
- [ ] ржЕрзНржпрж╛ржк рж▓ржЧржЗржи ржХрж░рж╛ ржЖржЫрзЗ
- [ ] ржЙржкржпрзБржХрзНржд ржкрж╛рж░ржорж┐рж╢ржи ржЖржЫрзЗ (Refund Manager)

### ржбрж╛ржЯрж╛ ржкрзНрж░рж╕рзНрждрзБрждрж┐

- [ ] ржХржоржкржХрзНрж╖рзЗ рзз ржЯрж┐ рж╕ржорзНржкржирзНржи ржмрж┐ржХрзНрж░ржпрж╝ ржЖржЫрзЗ
- [ ] ржмрж┐ржХрзНрж░ржпрж╝рзЗ ржЖржЗржЯрзЗржо ржЖржЫрзЗ (ржХржоржкржХрзНрж╖рзЗ рзз ржЯрж┐)
- [ ] ржмрж┐ржХрзНрж░ржпрж╝ ржПржХржЬржи ржЧрзНрж░рж╛рж╣ржХрзЗрж░ рж╕рж╛ржерзЗ (рж▓ржпрж╝рзНржпрж╛рж▓ржЯрж┐ ржкржпрж╝рзЗржирзНржЯрж╕ ржЬржирзНржп)
- [ ] ржЧрзНрж░рж╛рж╣ржХрзЗрж░ ржХрзЛржирзЛ рж▓ржпрж╝рзНржпрж╛рж▓ржЯрж┐ ржкржпрж╝рзЗржирзНржЯрж╕ ржЖржЫрзЗ

---

## ЁЯОп ржорзВрж▓ ржЯрзЗрж╕рзНржЯ ржкрзНрж░ржХрзНрж░рж┐ржпрж╝рж╛

### ржкрж░рзНржпрж╛ржпрж╝ рзз: ржкрзНрж░рж╛ржержорж┐ржХ ржЕржмрж╕рзНржерж╛ ржирж┐ржмржирзНржзржи

**рж╕рзЗрж▓ ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзБржи:**
```
Sale Number:        ________________________________
Sale Status:        ________________________________ (should be "completed")
Sale Date:          ________________________________
Customer Name:      ________________________________
Customer ID:        ________________________________
Total Amount:       ________________________________
Items in Sale:
  - Item 1:         ________________________________ x _______ units
  - Item 2:         ________________________________ x _______ units
```

**ржмрж░рзНрждржорж╛ржи ржЗржиржнрзЗржирзНржЯрж░рж┐ рж╕рзНрждрж░ ржирж┐ржмржирзНржзржи ржХрж░рзБржи:**
```
Item 1 Current Stock:    _______ units
Item 2 Current Stock:    _______ units
```

**ржмрж░рзНрждржорж╛ржи ржЧрзНрж░рж╛рж╣ржХ рж▓ржпрж╝рзНржпрж╛рж▓ржЯрж┐ ржкржпрж╝рзЗржирзНржЯрж╕ ржирж┐ржмржирзНржзржи ржХрж░рзБржи:**
```
Customer Loyalty Points Before:  _______ points
```

- [ ] рж╕ржм рждржерзНржп ржирж┐ржмржирзНржзрж┐ржд рж╣ржпрж╝рзЗржЫрзЗ

---

### ржкрж░рзНржпрж╛ржпрж╝ рзи: рж░рж┐ржлрж╛ржирзНржб рждрзИрж░рж┐ ржХрж░рзБржи

**рж░рж┐ржлрж╛ржирзНржб ржорзНржпрж╛ржирзЗржЬржорзЗржирзНржЯ ржнрж╛ржЧрзЗ ржпрж╛ржи:**
- [ ] Click "Refund Management" / "рж░рж┐ржлрж╛ржирзНржб ржмрзНржпржмрж╕рзНржерж╛ржкржирж╛"
- [ ] Click "New Refund" / "ржирждрзБржи рж░рж┐ржлрж╛ржирзНржб"

**рж░рж┐ржлрж╛ржирзНржб ржмрж┐ржмрж░ржг ржкрзВрж░ржг ржХрж░рзБржи:**
- [ ] Sale number ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзБржи (ржЖржкржирж╛рж░ ржкрж░рзАржХрзНрж╖рж╛ ржмрж┐ржХрзНрж░ржпрж╝)
- [ ] рж╕ржм ржЖржЗржЯрзЗржо ржирж┐рж░рзНржмрж╛ржЪрж┐ржд ржХрж░рзБржи (рж╕ржорзНржкрзВрж░рзНржг рж░рж┐ржлрж╛ржирзНржб)
- [ ] Refund Reason: "Testing Undo Sale" рж▓рж┐ржЦрзБржи
- [ ] Return Condition: "Good" ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзБржи
- [ ] "Restock Required" ржЪрзЗржХ ржХрж░рзБржи тЬУ
- [ ] Internal Notes: "Test verification" рж▓рж┐ржЦрзБржи

**рж░рж┐ржлрж╛ржирзНржб рждрзИрж░рж┐ ржХрж░рзБржи:**
- [ ] "Create Refund" / "рж░рж┐ржлрж╛ржирзНржб рждрзИрж░рж┐ ржХрж░рзБржи" ржХрзНрж▓рж┐ржХ ржХрж░рзБржи
- [ ] рж╕ржлрж▓ ржмрж╛рж░рзНрждрж╛ ржжрзЗржЦрзБржи тЬУ

**рж░рж┐ржлрж╛ржирзНржб ржиржорзНржмрж░ ржирж┐ржмржирзНржз ржХрж░рзБржи:**
```
Refund Number:  ________________________
Refund ID:      ________________________
Status:         ________________________ (should be "pending")
```

---

### ржкрж░рзНржпрж╛ржпрж╝ рей: рж░рж┐ржлрж╛ржирзНржб ржЕржирзБржорзЛржжржи ржХрж░рзБржи

**рж░рж┐ржлрж╛ржирзНржб ржЦрзБржБржЬрзЗ ржмрзЗрж░ ржХрж░рзБржи ржПржмржВ ржЦрзБрж▓рзБржи:**
- [ ] рж░рж┐ржлрж╛ржирзНржб рждрж╛рж▓рж┐ржХрж╛ржпрж╝ ржЧрж┐ржпрж╝рзЗ ржЦрзБржБржЬрзЗ ржмрзЗрж░ ржХрж░рзБржи
- [ ] рж░рж┐ржлрж╛ржирзНржб ржХрзНрж▓рж┐ржХ ржХрж░рзЗ ржЦрзБрж▓рзБржи

**ржмрж░рзНрждржорж╛ржи рж╕рзНржерж┐рждрж┐ ржпрж╛ржЪрж╛ржЗ ржХрж░рзБржи:**
- [ ] Status = "pending" ржмрж╛ "pending_approval"

**ржЕржирзБржорзЛржжржи ржХрж░рзБржи:**
- [ ] "Approve" / "ржЕржирзБржорзЛржжржи ржХрж░рзБржи" ржмрж╛ржЯржи ржХрзНрж▓рж┐ржХ ржХрж░рзБржи
- [ ] ржЕржирзБржорзЛржжржи ржХрж╛рж░ржг: "Testing" рж▓рж┐ржЦрзБржи
- [ ] "Confirm" / "ржирж┐рж╢рзНржЪрж┐ржд ржХрж░рзБржи" ржХрзНрж▓рж┐ржХ ржХрж░рзБржи
- [ ] рж╕ржлрж▓ ржмрж╛рж░рзНрждрж╛ ржжрзЗржЦрзБржи тЬУ

**ржирждрзБржи рж╕рзНржерж┐рждрж┐ ржпрж╛ржЪрж╛ржЗ ржХрж░рзБржи:**
- [ ] Status = "approved"

```
Approval Status: ________________________
Approved Time:   ________________________
```

---

### ржкрж░рзНржпрж╛ржпрж╝ рек: рж░рж┐ржлрж╛ржирзНржб ржкрзНрж░ржХрзНрж░рж┐ржпрж╝рж╛ ржХрж░рзБржи

**рж░рж┐ржлрж╛ржирзНржб ржЦрзБрж▓рзБржи (ржЕржирзБржорзЛржжржи ржХрж░рж╛):**
- [ ] рж░рж┐ржлрж╛ржирзНржб рждрж╛рж▓рж┐ржХрж╛ржпрж╝ ржЦрзБржБржЬрзЗ ржмрзЗрж░ ржХрж░рзБржи
- [ ] рж░рж┐ржлрж╛ржирзНржб ржХрзНрж▓рж┐ржХ ржХрж░рзЗ ржЦрзБрж▓рзБржи
- [ ] Status = "approved" ржпрж╛ржЪрж╛ржЗ ржХрж░рзБржи

**ржкрзНрж░ржХрзНрж░рж┐ржпрж╝рж╛ ржХрж░рзБржи:**
- [ ] "Process" / "ржкрзНрж░ржХрзНрж░рж┐ржпрж╝рж╛ ржХрж░рзБржи" ржмрж╛ржЯржи ржХрзНрж▓рж┐ржХ ржХрж░рзБржи
- [ ] "Confirm" / "ржирж┐рж╢рзНржЪрж┐ржд ржХрж░рзБржи" ржХрзНрж▓рж┐ржХ ржХрж░рзБржи
- [ ] рж╕ржлрж▓ ржмрж╛рж░рзНрждрж╛ ржжрзЗржЦрзБржи тЬУ

**ржирждрзБржи рж╕рзНржерж┐рждрж┐ ржпрж╛ржЪрж╛ржЗ ржХрж░рзБржи:**
- [ ] Status = "processed"

```
Processed Time:  ________________________
```

---

### ржкрж░рзНржпрж╛ржпрж╝ рел: рж░рж┐ржлрж╛ржирзНржб рж╕ржорзНржкржирзНржи ржХрж░рзБржи (UNDO SALE TRIGGER)

**рж░рж┐ржлрж╛ржирзНржб ржЦрзБрж▓рзБржи (ржкрзНрж░ржХрзНрж░рж┐ржпрж╝рж╛ ржХрж░рж╛):**
- [ ] рж░рж┐ржлрж╛ржирзНржб рждрж╛рж▓рж┐ржХрж╛ржпрж╝ ржЦрзБржБржЬрзЗ ржмрзЗрж░ ржХрж░рзБржи
- [ ] рж░рж┐ржлрж╛ржирзНржб ржХрзНрж▓рж┐ржХ ржХрж░рзЗ ржЦрзБрж▓рзБржи
- [ ] Status = "processed" ржпрж╛ржЪрж╛ржЗ ржХрж░рзБржи

**рж╕ржорзНржкрзВрж░рзНржг ржХрж░рзБржи (ржПржЯрж┐ UNDO SALE ржЯрзНрж░рж┐ржЧрж╛рж░ ржХрж░ржмрзЗ):**
- [ ] Return Condition ржбрзНрж░ржкржбрж╛ржЙржи: "Good" ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзБржи
- [ ] Inspection Notes: "Test verification" рж▓рж┐ржЦрзБржи
- [ ] **"Complete Refund"** / **"рж░рж┐ржлрж╛ржирзНржб рж╕ржорзНржкрзВрж░рзНржг ржХрж░рзБржи"** ржХрзНрж▓рж┐ржХ ржХрж░рзБржи
  
  тЪая╕П **ржПржЯрж┐ рж╕ржорж╕рзНржд UNDO SALE рж▓ржЬрж┐ржХ ржЯрзНрж░рж┐ржЧрж╛рж░ ржХрж░ржмрзЗ!**

- [ ] рж╕ржлрж▓ ржмрж╛рж░рзНрждрж╛ ржжрзЗржЦрзБржи тЬУ
- [ ] Status ржкрж░рж┐ржмрж░рзНрждрж┐ржд рж╣ржпрж╝рзЗржЫрзЗ "completed" рждрзЗ

```
Completion Time:  ________________________
Completion Status: ________________________
```

---

## ЁЯФН ржпрж╛ржЪрж╛ржЗржХрж░ржг ржкрж░рзНржпрж╛ржпрж╝ - ржмрж┐рж╕рзНрждрж╛рж░рж┐ржд ржЪрзЗржХ

### тЬЕ ржпрж╛ржЪрж╛ржЗржХрж░ржг #1: Sale Status ржкрж░рж┐ржмрж░рзНрждрж┐ржд рж╣ржпрж╝рзЗржЫрзЗ

**ржХрж┐ ржШржЯрж╛ ржЙржЪрж┐ржд:**
- Sale status ржкрж░рж┐ржмрж░рзНрждржи рж╣ржпрж╝рзЗржЫрзЗ "completed" ржерзЗржХрзЗ "cancelled" ржП
- ржПржЯрж┐ ржПржХржЯрж┐ ржжрзАрж░рзНржШржорзЗржпрж╝рж╛ржжрзА ржкрж░рж┐ржмрж░рзНрждржи

**ржХрж┐ржнрж╛ржмрзЗ ржЪрзЗржХ ржХрж░ржмрзЗржи:**

**Option A: UI ржП ржЪрзЗржХ ржХрж░рзБржи**
```
1. Sales List / "ржмрж┐ржХрзНрж░ржпрж╝ рждрж╛рж▓рж┐ржХрж╛" ржпрж╛ржи
2. Default view (рж╕ржХрзНрж░рж┐ржпрж╝ ржмрж┐ржХрзНрж░ржпрж╝ рж╢рзБржзрзБржорж╛рждрзНрж░)
3. ржЖржкржирж╛рж░ ржкрж░рзАржХрзНрж╖рж╛ рж╕рзЗрж▓ ржЦрзБржБржЬрзБржи
```

**ржлрж▓рж╛ржлрж▓:**
- [ ] Sale **ржжрзГрж╢рзНржпржорж╛ржи ржиржпрж╝** (ржлрж┐рж▓рзНржЯрж╛рж░ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ) тЖТ **тЬЕ рж╕ржарж┐ржХ**
- [ ] Sale ржПржЦржиржУ ржжрзГрж╢рзНржпржорж╛ржи тЖТ **тЭМ рж╕ржорж╕рзНржпрж╛**

**Option B: рж╕ржм ржмрж┐ржХрзНрж░ржпрж╝ ржжрзЗржЦрж╛ржи (ржлрж┐рж▓рзНржЯрж╛рж░ рж╕рж╣)**
```
1. Sales List / "ржмрж┐ржХрзНрж░ржпрж╝ рждрж╛рж▓рж┐ржХрж╛" ржпрж╛ржи
2. Filter: "Show All Sales" ржмрж╛ "Include Cancelled"
3. ржЖржкржирж╛рж░ ржкрж░рзАржХрзНрж╖рж╛ рж╕рзЗрж▓ ржЦрзБржБржЬрзБржи
4. Status column ржжрзЗржЦрзБржи
```

**ржлрж▓рж╛ржлрж▓:**
- [ ] Status = **"cancelled"** тЖТ **тЬЕ рж╕ржарж┐ржХ**
- [ ] Status = ржЕржирзНржп ржХрж┐ржЫрзБ тЖТ **тЭМ рж╕ржорж╕рзНржпрж╛**

**Option C: Convex Dashboard ржбрж╛ржЯрж╛ ржЪрзЗржХ ржХрж░рзБржи**
```
1. Convex Dashboard ржЦрзБрж▓рзБржи
2. Table: "sales" 
3. Query: { saleNumber: "SAL-XXXX" }
4. Field ржжрзЗржЦрзБржи: "status"
```

**ржлрж▓рж╛ржлрж▓:**
- [ ] "cancelled" ржЖржЫрзЗ тЖТ **тЬЕ рж╕ржарж┐ржХ**

```
VERIFICATION #1 RESULT: [ PASS / FAIL ]
Notes: ______________________________________________
```

---

### тЬЕ ржпрж╛ржЪрж╛ржЗржХрж░ржг #2: Inventory Stock ржкрзБржирж░рзБржжрзНржзрж╛рж░ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ

**ржХрж┐ ржШржЯрж╛ ржЙржЪрж┐ржд:**
- ржкрзНрж░рждрж┐ржЯрж┐ ржкржгрзНржпрзЗрж░ рж╕рзНржЯржХ ржмрзГржжрзНржзрж┐ ржкрзЗржпрж╝рзЗржЫрзЗ (рж░рж┐ржлрж╛ржирзНржб ржкрж░рж┐ржорж╛ржг ржжрзНржмрж╛рж░рж╛)
- рж╕рзНржЯржХ ржорзБржнржорзЗржирзНржЯ рж░рзЗржХрж░рзНржб рждрзИрж░рж┐ рж╣ржпрж╝рзЗржЫрзЗ

**ржХрж┐ржнрж╛ржмрзЗ ржЪрзЗржХ ржХрж░ржмрзЗржи:**

**Step 1: Product Stock ржжрзЗржЦрзБржи**
```
1. Inventory / "ржЗржиржнрзЗржирзНржЯрж░рж┐" ржпрж╛ржи
2. ржЖржкржирж╛рж░ ржкржгрзНржп ржЦрзБржБржЬрзБржи (Item 1)
3. "Stock Level" ржжрзЗржЦрзБржи
```

**рж░рзЗржХрж░рзНржб ржХрж░рзБржи:**
```
Item 1:
  Before: _______ units
  After:  _______ units
  Difference: _______ units
  
Expected increase: (refund quantity) = _______ units

Result: [ MATCHES / MISMATCH ]
```

**Step 2: Stock Movements рж░рзЗржХрж░рзНржб ржжрзЗржЦрзБржи**
```
1. Inventory > "Stock Movements" / "рж╕рзНржЯржХ ржорзБржнржорзЗржирзНржЯрж╕"
2. Filter: Reason = "Undo Sale Return" ржмрж╛ Reference = ржЖржкржирж╛рж░ Refund
3. ржПржирзНржЯрзНрж░рж┐ ржЦрзБржБржЬрзБржи
```

**рж░рзЗржХрж░рзНржб ржХрж░рзБржи:**
```
Movement Found: [ YES / NO ]

If YES:
  Type:       ________________________ (should be "in")
  Quantity:   ________________________
  Reason:     ________________________ (should be "Undo Sale Return")
  Reference:  ________________________ (should be refund number)
  Timestamp:  ________________________
```

**Step 3: Branch Stock ржЖржкржбрзЗржЯ (ржпржжрж┐ ржкрзНрж░ржпрзЛржЬрзНржп)**
```
1. Product ржмрж┐ржмрж░ржгрзЗ ржпрж╛ржи
2. "Branch Stock" array ржжрзЗржЦрзБржи
3. ржЖржкржирж╛рж░ рж╢рж╛ржЦрж╛рж░ stock ржпрж╛ржЪрж╛ржЗ ржХрж░рзБржи
```

**ржлрж▓рж╛ржлрж▓:**
- [ ] Stock ржмрзГржжрзНржзрж┐ ржкрзЗржпрж╝рзЗржЫрзЗ рж╕ржарж┐ржХ ржкрж░рж┐ржорж╛ржгрзЗ тЖТ **тЬЕ рж╕ржарж┐ржХ**
- [ ] Stock ржЖржкржбрзЗржЯ рж╣ржпрж╝ржирж┐ тЖТ **тЭМ рж╕ржорж╕рзНржпрж╛**

```
VERIFICATION #2 RESULT: [ PASS / FAIL ]
Notes: ______________________________________________
```

---

### тЬЕ ржпрж╛ржЪрж╛ржЗржХрж░ржг #3: Loyalty Points ржкрж░рж┐ржмрж░рзНрждрж┐ржд рж╣ржпрж╝рзЗржЫрзЗ

**ржХрж┐ ржШржЯрж╛ ржЙржЪрж┐ржд:**
- ржЧрзНрж░рж╛рж╣ржХрзЗрж░ рж▓ржпрж╝рзНржпрж╛рж▓ржЯрж┐ ржкржпрж╝рзЗржирзНржЯрж╕ рж╣рзНрж░рж╛рж╕ ржкрзЗржпрж╝рзЗржЫрзЗ (ржЕрж░рзНржЬрж┐ржд ржкржпрж╝рзЗржирзНржЯрж╕ ржжрзНржмрж╛рж░рж╛)
- ржкржпрж╝рзЗржирзНржЯрж╕ рж▓рзЗржиржжрзЗржи рж░рзЗржХрж░рзНржб рждрзИрж░рж┐ рж╣ржпрж╝рзЗржЫрзЗ (ржЯрж╛ржЗржк: "refund")

**ржХрж┐ржнрж╛ржмрзЗ ржЪрзЗржХ ржХрж░ржмрзЗржи:**

**Step 1: Customer Loyalty Points ржжрзЗржЦрзБржи**
```
1. Customers / "ржЧрзНрж░рж╛рж╣ржХрж░рж╛" ржпрж╛ржи
2. ржЖржкржирж╛рж░ ржЧрзНрж░рж╛рж╣ржХ ржЦрзБржБржЬрзБржи
3. "Loyalty Points" ржлрж┐рж▓рзНржб ржжрзЗржЦрзБржи
```

**рж░рзЗржХрж░рзНржб ржХрж░рзБржи:**
```
Customer: __________________________

Before:  _______ points
After:   _______ points
Difference: _______ points

Expected decrease: (points from original sale) = ?
```

**ржпрж╛ржЪрж╛ржЗ:**
- [ ] After = Before - Earned Points тЖТ **тЬЕ рж╕ржарж┐ржХ**
- [ ] Points ржорж┐рж▓ржЫрзЗ ржирж╛ тЖТ **тЭМ рж╕ржорж╕рзНржпрж╛**
- [ ] ржЧрзНрж░рж╛рж╣ржХрзЗрж░ ржЖржЧрзЗ ржХрзЛржирзЛ ржкржпрж╝рзЗржирзНржЯрж╕ ржЫрж┐рж▓ ржирж╛ тЖТ **тЪая╕П N/A**

**Step 2: Points Transactions ржжрзЗржЦрзБржи**
```
1. Customers > [Customer] > "Loyalty History"
2. ржкрж░ржмрж░рзНрждрзА рж▓рзЗржиржжрзЗржи ржЦрзБржБржЬрзБржи
```

**OR Convex Dashboard:**
```
1. Table: "pointsTransactions"
2. Query: { customerId: "...", transactionType: "refund" }
3. ржПржирзНржЯрзНрж░рж┐ ржЦрзБржБржЬрзБржи
```

**рж░рзЗржХрж░рзНржб ржХрж░рзБржи:**
```
Transaction Found: [ YES / NO ]

If YES:
  Type:        ________________________ (should be "refund")
  Points:      ________________________ (should be negative)
  Description: ________________________
  Reference:   ________________________ (should link to sale)
```

**ржлрж▓рж╛ржлрж▓:**
- [ ] Points рж╣рзНрж░рж╛рж╕ ржкрзЗржпрж╝рзЗржЫрзЗ рж╕ржарж┐ржХржнрж╛ржмрзЗ тЖТ **тЬЕ рж╕ржарж┐ржХ**
- [ ] Points ржЖржкржбрзЗржЯ рж╣ржпрж╝ржирж┐ тЖТ **тЭМ рж╕ржорж╕рзНржпрж╛** (ржХрж┐ржирзНрждрзБ OK ржпржжрж┐ ржХрзЛржирзЛ points ржЫрж┐рж▓ ржирж╛)
- [ ] Transaction рж░рзЗржХрж░рзНржб ржирзЗржЗ тЖТ **тЪая╕П ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг ржиржпрж╝ ржпржжрж┐ points update OK**

```
VERIFICATION #3 RESULT: [ PASS / FAIL / N/A ]
Notes: ______________________________________________
```

---

### тЬЕ ржпрж╛ржЪрж╛ржЗржХрж░ржг #4: Payment Reversal ржбржХрзБржорзЗржирзНржЯ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ

**ржХрж┐ ржШржЯрж╛ ржЙржЪрж┐ржд:**
- Refund Audit Trail ржП ржПржХржЯрж┐ "COMPLETED" ржПржирзНржЯрзНрж░рж┐ ржЖржЫрзЗ
- ржирзЛржЯрзЗ ржкрзЗржорзЗржирзНржЯ рж░рж┐ржнрж╛рж░рзНрж╕рж╛рж▓ рждржерзНржп ржЖржЫрзЗ

**ржХрж┐ржнрж╛ржмрзЗ ржЪрзЗржХ ржХрж░ржмрзЗржи:**

**Step 1: Refund ржЦрзБрж▓рзБржи**
```
1. Refund Management / "рж░рж┐ржлрж╛ржирзНржб ржмрзНржпржмрж╕рзНржерж╛ржкржирж╛" ржпрж╛ржи
2. ржЖржкржирж╛рж░ ржЯрзЗрж╕рзНржЯ рж░рж┐ржлрж╛ржирзНржб ржЦрзБржБржЬрзБржи
3. рж░рж┐ржлрж╛ржирзНржб ржХрзНрж▓рж┐ржХ ржХрж░рзЗ ржЦрзБрж▓рзБржи
```

**Step 2: Audit Trail ржжрзЗржЦрзБржи**
```
1. рж░рж┐ржлрж╛ржирзНржб details ржкрзГрж╖рзНржарж╛ржпрж╝ ржирж┐ржЪрзЗ ржпрж╛ржи
2. "Audit Trail" / "ржЕржбрж┐ржЯ ржЯрзНрж░рзЗржЗрж▓" рж╕рзЗржХрж╢ржи ржЦрзБржБржЬрзБржи
3. "View Audit Trail" ржХрзНрж▓рж┐ржХ ржХрж░рзБржи (ржпржжрж┐ ржХрзЛржпрж╝рж╛рж▓рж╛ржкрж╕рж┐ржмрж▓ рж╣ржпрж╝)
4. рж╕ржм entries ржжрзЗржЦрзБржи
```

**рж░рзЗржХрж░рзНржб ржХрж░рзБржи:**
```
Total Audit Entries: _______ entries

Entry 1:
  Action Type: ________________________
  Status Change: ________________________
  Notes: ________________________...

Entry 2:
  Action Type: ________________________
  Notes: ________________________...

Entry 3 (Summary):
  Action Type: ________________________ (should be "completed")
  Notes: ________________________...
  Contains "Payment reversal"?: [ YES / NO ]
  Contains amount "$"?: [ YES / NO ]
```

**ржЦрзБржБржЬрзБржи: рж╕рж╛рж░рж╕ржВржХрзНрж╖рзЗржк ржПржирзНржЯрзНрж░рж┐**
```
Should contain text like:
"тЬЕ UNDO SALE COMPLETED - All transactions reversed.
 Payment of $[AMOUNT] reversed"
```

**ржлрж▓рж╛ржлрж▓:**
- [ ] рж╕рж╛рж░рж╕ржВржХрзНрж╖рзЗржк ржПржирзНржЯрзНрж░рж┐ ржЖржЫрзЗ тЖТ **тЬЕ рж╕ржарж┐ржХ**
- [ ] ржкрзЗржорзЗржирзНржЯ рж░рж┐ржнрж╛рж░рзНрж╕рж╛рж▓ ржирзЛржЯ ржЖржЫрзЗ тЖТ **тЬЕ рж╕ржарж┐ржХ**
- [ ] ржХрзЛржирзЛ ржПржирзНржЯрзНрж░рж┐ ржирзЗржЗ тЖТ **тЭМ рж╕ржорж╕рзНржпрж╛**

```
VERIFICATION #4 RESULT: [ PASS / FAIL ]
Notes: ______________________________________________
```

---

### тЬЕ ржпрж╛ржЪрж╛ржЗржХрж░ржг #5: рж╕ржорзНржкрзВрж░рзНржг ржЕржбрж┐ржЯ ржЯрзНрж░рзЗржЗрж▓ рж░рзЗржХрж░рзНржб ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ

**ржХрж┐ ржШржЯрж╛ ржЙржЪрж┐ржд:**
- ржХржоржкржХрзНрж╖рзЗ рзйржЯрж┐ ржЕржбрж┐ржЯ ржПржирзНржЯрзНрж░рж┐ ржЖржЫрзЗ:
  1. Discount reversal (ржпржжрж┐ discount ржЫрж┐рж▓)
  2. Tax reversal (ржпржжрж┐ tax ржЫрж┐рж▓)
  3. Completion summary

**ржХрж┐ржнрж╛ржмрзЗ ржЪрзЗржХ ржХрж░ржмрзЗржи:**

**Audit Trail рж╕ржм entries ржжрзЗржЦрзБржи:**
```
1. Refund ржЦрзБрж▓рзБржи
2. Audit Trail ржжрзЗржЦрзБржи
3. ржкрзНрж░рждрж┐ржЯрж┐ entry ржкржбрж╝рзБржи
```

**рж░рзЗржХрж░рзНржб ржХрж░рзБржи:**
```
ржПржирзНржЯрзНрж░рж┐ ржЧржгржирж╛ ржХрж░рзБржи:

[ ] discount_reversal entry (ржмрж┐ржХрж▓рзНржк)
[ ] tax_reversal entry (ржмрж┐ржХрж▓рзНржк)  
[ ] completed entry (ржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝)

ржорзЛржЯ ржкрзНрж░рждрзНржпрж╛рж╢рж┐ржд ржПржирзНржЯрзНрж░рж┐: 3 (ржмрж╛ 1 ржпржжрж┐ ржХрзЛржи discount/tax)
ржЖржкржирж╛рж░ ржЧржгржирж╛: _______ entries

Each entry has:
[ ] Timestamp
[ ] User info
[ ] Action type
[ ] Detailed notes

Summary Entry contains:
[ ] "тЬЕ UNDO SALE COMPLETED"
[ ] Sale number
[ ] Payment amount
[ ] Stock restoration info
[ ] Points reversal info
```

**ржлрж▓рж╛ржлрж▓:**
- [ ] рж╕ржм ржкрзНрж░ржпрж╝рзЛржЬржирзАржпрж╝ ржПржирзНржЯрзНрж░рж┐ ржЖржЫрзЗ тЖТ **тЬЕ рж╕ржарж┐ржХ**
- [ ] ржХрж┐ржЫрзБ ржПржирзНржЯрзНрж░рж┐ ржирзЗржЗ тЖТ **тЭМ рж╕ржорж╕рзНржпрж╛**
- [ ] ржПржирзНржЯрзНрж░рж┐ ржЧрзБрж▓рж┐ рж╕ржорзНржкрзВрж░рзНржг ржиржпрж╝ тЖТ **тЪая╕П ржЕржзрзВрж░рж╛**

```
VERIFICATION #5 RESULT: [ PASS / FAIL ]
Notes: ______________________________________________
```

---

## ЁЯУК ржЪрзВржбрж╝рж╛ржирзНржд ржЯрзЗрж╕рзНржЯ ржлрж▓рж╛ржлрж▓ рж╕рж╛рж░рж╕ржВржХрзНрж╖рзЗржк

### ржлрж▓рж╛ржлрж▓ рж╕ржВржХрзНрж╖рж┐ржкрзНрждржХрж░ржг

| ржпрж╛ржЪрж╛ржЗржХрж░ржг | ржлрж▓рж╛ржлрж▓ | ржирзЛржЯрж╕ |
|----------|--------|-------|
| #1: Sale Cancelled | [ PASS / FAIL ] | ______________ |
| #2: Stock Restored | [ PASS / FAIL ] | ______________ |
| #3: Points Reversed | [ PASS / FAIL ] | ______________ |
| #4: Payment Documented | [ PASS / FAIL ] | ______________ |
| #5: Audit Trail Complete | [ PASS / FAIL ] | ______________ |

### рж╕рж╛ржоржЧрзНрж░рж┐ржХ ржлрж▓рж╛ржлрж▓

**рж╕ржм ржкрж╛рж╕ ржХрж░рж▓рзЗ:**
- [ ] **тЬЕ UNDO SALE ржмрзИрж╢рж┐рж╖рзНржЯрзНржп рж╕ржорзНржкрзВрж░рзНржгржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░ржЫрзЗ!**

**ржХрзЛржи ржмрзНржпрж░рзНржерждрж╛ рж╣рж▓рзЗ:**
- [ ] **тЪая╕П рж╕ржорж╕рзНржпрж╛ рж╕ржорж╛ржзрж╛ржи ржкрзНрж░ржпрж╝рзЛржЬржи**

```
OVERALL TEST RESULT: [ PASS / FAIL ]
```

---

## ЁЯРЫ ржпржжрж┐ ржХрзЛржирзЛ ржЯрзЗрж╕рзНржЯ ржмрзНржпрж░рзНрже рж╣ржпрж╝

### рж╕ржорж╕рзНржпрж╛ рж╕ржорж╛ржзрж╛ржи ржорзНржпрж╛ржЯрзНрж░рж┐ржХрзНрж╕

| ржмрзНржпрж░рзНржерждрж╛ ржмрж┐ржирзНржжрзБ | рж╕ржорзНржнрж╛ржмрзНржп ржХрж╛рж░ржг | ржкржжржХрзНрж╖рзЗржк |
|-------------|-------------|--------|
| Sale ржирж╛ ржжрзГрж╢рзНржпржорж╛ржи ржХрж┐ржирзНрждрзБ Cancelled ржирж╛ | Cache/Filter | Page refresh, ржлрж┐рж▓рзНржЯрж╛рж░ ржЪрзЗржХ |
| Stock ржЖржкржбрзЗржЯ ржирж╛ | Restock disabled | Refund ржП restock enable ржХрж░рзБржи |
| Points ржирж╛ ржкрж░рж┐ржмрж░рзНрждрж┐ржд | No original points | рж▓ржпрж╝рзНржпрж╛рж▓ржЯрж┐ ржкрзНрж░рзЛржЧрзНрж░рж╛ржо ржЪрзЗржХ ржХрж░рзБржи |
| ржХрзЛржирзЛ Audit ржПржирзНржЯрзНрж░рж┐ ржирж╛ | DB issue | Convex logs ржЪрзЗржХ ржХрж░рзБржи |

---

## ЁЯУЭ рж╢рзЗрж╖ ржирзЛржЯрж╕

```
ржкрж░рзАржХрзНрж╖рж╛ рждрж╛рж░рж┐ржЦ:       ________________________
ржЯрзЗрж╕рзНржЯрж╛рж░ ржирж╛ржо:        ________________________
ржЯрзЗрж╕рзНржЯ ржмрж┐ржХрзНрж░ржпрж╝ ржиржорзНржмрж░:  ________________________
ржЯрзЗрж╕рзНржЯ рж░рж┐ржлрж╛ржирзНржб ржиржорзНржмрж░:  ________________________

рж╕рж╛ржоржЧрзНрж░рж┐ржХ ржоржирзНрждржмрзНржп:
_________________________________________________________
_________________________________________________________
_________________________________________________________

рж╕рзБржкрж╛рж░рж┐рж╢:
_________________________________________________________
_________________________________________________________

ржЕржирзБржорзЛржжржи:           [ ржЕржирзБржорзЛржжрж┐ржд / ржкрзНрж░ржпрж╝рзЛржЬржи рж╕ржВрж╢рзЛржзржи ]
ржЕржирзБржорзЛржжржиржХрж╛рж░рзА:       ________________________
```

---

**ржЯрзЗрж╕рзНржЯрж┐ржВ рж╕ржорзНржкрзВрж░рзНржг рж╣ржпрж╝рзЗржЫрзЗ!** тЬЕ

рж╕ржм ржпрж╛ржЪрж╛ржЗржХрж░ржг ржкрж╛рж╕ рж╣рж▓рзЗ, Undo Sale ржмрзИрж╢рж┐рж╖рзНржЯрзНржп ржЙрзОржкрж╛ржжржирзЗрж░ ржЬржирзНржп ржкрзНрж░рж╕рзНрждрзБржд! ЁЯОЙ
