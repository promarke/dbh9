# ржмрзНрж░рж╛ржЮрзНржЪ ржПржмржВ ржЗржиржнрзЗржирзНржЯрж░рж┐ ржорзНржпрж╛ржирзЗржЬржорзЗржирзНржЯ - ржкрзНрж░ржпрзБржХрзНрждрж┐ржЧржд рж╕рзНржЯрзНржпрж╛ржХ

## ЁЯПЧя╕П ржЖрж░рзНржХрж┐ржЯрзЗржХржЪрж╛рж░ ржУржнрж╛рж░ржнрж┐ржЙ

```
тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР
тФВ                    USER INTERFACE LAYER                      тФВ
тФВ  (React Components - Settings, Dashboard, Inventory)         тФВ
тФФтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФмтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФШ
                         тФВ
                         тЦ╝
тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР
тФВ                   API/MUTATION LAYER                         тФВ
тФВ  (Convex Functions - branches.ts, products.ts, etc.)         тФВ
тФФтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФмтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФШ
                         тФВ
                         тЦ╝
тФМтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФР
тФВ                   DATABASE SCHEMA                            тФВ
тФВ  (Convex Database - Collections)                             тФВ
тФФтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФАтФШ
```

---

## ЁЯУБ рж╕ржорзНржкрж░рзНржХрж┐ржд ржлрж╛ржЗрж▓ ржХрж╛ржарж╛ржорзЛ

```
convex/
тФЬтФАтФА schema.ts                 # ржбрж╛ржЯрж╛ржмрзЗрж╕ рж╕рзНржХрж┐ржорж╛ рж╕ржВржЬрзНржЮрж╛
тФВ   тФЬтФАтФА branches              # рж╢рж╛ржЦрж╛ рждржерзНржп
тФВ   тФЬтФАтФА employees             # ржХрж░рзНржоржЪрж╛рж░рзА ржбрж╛ржЯрж╛
тФВ   тФЬтФАтФА products              # ржкржгрзНржп ржмрж┐ржмрж░ржг
тФВ   тФЬтФАтФА sales                 # ржмрж┐ржХрзНрж░ржпрж╝ рж░рзЗржХрж░рзНржб
тФВ   тФЬтФАтФА stockMovements        # рж╕рзНржЯржХ ржЯрзНрж░рж╛ржирзНрж╕ржлрж╛рж░ рж▓ржЧ
тФВ   тФЬтФАтФА stockTransfer         # ржкрзЗржирзНржбрж┐ржВ ржЯрзНрж░рж╛ржирзНрж╕ржлрж╛рж░
тФВ   тФЬтФАтФА userManagement        # ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржЕрзНржпрж╛ржХрж╛ржЙржирзНржЯ
тФВ   тФЬтФАтФА userRoles             # ржнрзВржорж┐ржХрж╛ рж╕ржВржЬрзНржЮрж╛
тФВ   тФФтФАтФА userRules             # рж╢рж░рзНржд-ржнрж┐рждрзНрждрж┐ржХ ржирж┐ржпрж╝ржо
тФВ
тФЬтФАтФА branches.ts               # ржмрзНрж░рзНржпрж╛ржЮрзНржЪ ржЕржкрж╛рж░рзЗрж╢ржи
тФВ   тФЬтФАтФА list()                # рж╕ржм ржмрзНрж░рзНржпрж╛ржЮрзНржЪ ржжрзЗржЦрж╛
тФВ   тФЬтФАтФА get()                 # ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржмрзНрж░рзНржпрж╛ржЮрзНржЪ ржжрзЗржЦрж╛
тФВ   тФЬтФАтФА create()              # ржирждрзБржи ржмрзНрж░рзНржпрж╛ржЮрзНржЪ рждрзИрж░рж┐
тФВ   тФФтФАтФА update()              # ржмрзНрж░рзНржпрж╛ржЮрзНржЪ рж╕ржорзНржкрж╛ржжржирж╛
тФВ
тФЬтФАтФА products.ts               # ржкржгрзНржп ржмрзНржпржмрж╕рзНржерж╛ржкржирж╛
тФВ   тФЬтФАтФА list()                # ржкржгрзНржпрзЗрж░ рждрж╛рж▓рж┐ржХрж╛
тФВ   тФЬтФАтФА get()                 # ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржкржгрзНржп
тФВ   тФЬтФАтФА create()              # ржирждрзБржи ржкржгрзНржп ржпрзЛржЧ ржХрж░рзБржи
тФВ   тФЬтФАтФА update()              # ржкржгрзНржп рж╕ржорзНржкрж╛ржжржирж╛ ржХрж░рзБржи
тФВ   тФФтФАтФА delete()              # ржкржгрзНржп ржирж┐рж╖рзНржХрзНрж░рж┐ржпрж╝ ржХрж░рзБржи
тФВ
тФЬтФАтФА stockManagement.ts        # ржЗржиржнрзЗржирзНржЯрж░рж┐ ржирж┐ржпрж╝ржирзНрждрзНрж░ржг
тФВ   тФЬтФАтФА getBranchInventory()  # ржмрзНрж░рзНржпрж╛ржЮрзНржЪ рж╕рзНржЯржХ ржжрзЗржЦрзБржи
тФВ   тФЬтФАтФА adjustStock()         # рж╕рзНржЯржХ рж╕рж╛ржоржЮрзНржЬрж╕рзНржп ржХрж░рзБржи
тФВ   тФФтФАтФА getLowStockItems()    # ржХржо рж╕рзНржЯржХ рж╕рждрж░рзНржХрждрж╛
тФВ
тФЬтФАтФА employees.ts              # ржХрж░рзНржоржЪрж╛рж░рзА ржмрзНржпржмрж╕рзНржерж╛ржкржирж╛
тФВ   тФЬтФАтФА list()                # ржХрж░рзНржоржЪрж╛рж░рзА рждрж╛рж▓рж┐ржХрж╛
тФВ   тФЬтФАтФА create()              # ржирждрзБржи ржХрж░рзНржоржЪрж╛рж░рзА ржпрзЛржЧ ржХрж░рзБржи
тФВ   тФФтФАтФА update()              # ржХрж░рзНржоржЪрж╛рж░рзА рждржерзНржп рж╕ржорзНржкрж╛ржжржирж╛
тФВ
тФЬтФАтФА userManagement.ts         # ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржЕрзНржпрж╛ржХрж╛ржЙржирзНржЯ
тФВ   тФЬтФАтФА createUser()          # ржирждрзБржи ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА
тФВ   тФЬтФАтФА updateUser()          # ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА рж╕ржорзНржкрж╛ржжржирж╛
тФВ   тФФтФАтФА listUsers()           # рж╕ржм ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА
тФВ
тФЬтФАтФА userRules.ts              # ржнрзВржорж┐ржХрж╛ ржПржмржВ ржирж┐ржпрж╝ржо
тФВ   тФЬтФАтФА createRole()          # ржирждрзБржи ржнрзВржорж┐ржХрж╛
тФВ   тФЬтФАтФА createRule()          # ржирждрзБржи ржирж┐ржпрж╝ржо
тФВ   тФФтФАтФА applyRulesToUser()    # ржирж┐ржпрж╝ржо ржкрзНрж░ржпрж╝рзЛржЧ ржХрж░рзБржи
тФВ
тФФтФАтФА roleSeed.ts               # ржбрж┐ржлрж▓рзНржЯ ржнрзВржорж┐ржХрж╛ рж╕рзЗржЯржЖржк

src/components/
тФЬтФАтФА BranchManagement.tsx      # ржмрзНрж░рзНржпрж╛ржЮрзНржЪ UI
тФЬтФАтФА EmployeeManagement.tsx    # ржХрж░рзНржоржЪрж╛рж░рзА UI
тФЬтФАтФА InventoryManagement.tsx   # ржЗржиржнрзЗржирзНржЯрж░рж┐ UI
тФЬтФАтФА UserManagement.tsx        # ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржмрзНржпржмрж╕рзНржерж╛ржкржирж╛ UI
тФЬтФАтФА RuleBasedUserManagement.tsx # ржнрзВржорж┐ржХрж╛ ржПржмржВ ржирж┐ржпрж╝ржо UI
тФЬтФАтФА Dashboard.tsx             # ржорзВрж▓ ржбрзНржпрж╛рж╢ржмрзЛрж░рзНржб
тФФтФАтФА Settings.tsx              # рж╕рзЗржЯрж┐ржВрж╕ ржкрзГрж╖рзНржарж╛
```

---

## ЁЯФД ржкрзНрж░ржзрж╛ржи ржбрж╛ржЯрж╛ ржлрзНрж▓рзЛ

### ржбрж╛ржЯрж╛ ржлрзНрж▓рзЛ рзз: ржирждрзБржи ржкржгрзНржп ржпрзЛржЧ ржХрж░рж╛

```
ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА тЖТ UI           тЖТ API              тЖТ Database
   (рж╕рзБржкрж╛рж░     (ржкржгрзНржп        (products.ts       (products
   ржЕрзНржпрж╛ржбржорж┐ржи)    рж╕ржВржпрзЛржЬржи)      create())          рж╕ржВржЧрзНрж░рж╣)
     тФВ             тФВ              тФВ                 тФВ
     тФВ             тФВ              тФВ                 тФВ
  ржлрж░рзНржо ржкрзВрж░ржг тФАтФАтЖТ ржкржгрзНржп ржмрж┐ржмрж░ржг тФАтФАтЖТ рж╕рзНржЯржХ ржХрж░рзБржи тФАтФАтЖТ рж╕ржВрж░ржХрзНрж╖ржг ржХрж░рзБржи
  ржХрж░рзБржи          рж╕ржВржЧрзНрж░рж╣ ржХрж░рзБржи     ржкрзНрж░рждрж┐ржЯрж┐        ржбрж╛ржЯрж╛ржмрзЗрж╕рзЗ
                                  ржмрзНрж░рзНржпрж╛ржЮрзНржЪрзЗрж░ ржЬржирзНржп
```

### ржбрж╛ржЯрж╛ ржлрзНрж▓рзЛ рзи: ржмрж┐ржХрзНрж░ржпрж╝ рж░рзЗржХрж░рзНржб ржХрж░рж╛

```
ржХрзНржпрж╛рж╢рж┐ржпрж╝рж╛рж░    тЖТ POS         тЖТ ржмрж┐ржХрзНрж░ржпрж╝ API     тЖТ рж╕рзНржЯржХ ржЖржкржбрзЗржЯ
   (ржЖржЗржЯрзЗржо         (рж▓рзЗржиржжрзЗржи       (sales.ts       (рж╕рзНржмржпрж╝ржВржХрзНрж░рж┐ржпрж╝)
   рж╕рзНржХрзНржпрж╛ржи)        ржкрзНрж░ржХрзНрж░рж┐ржпрж╝рж╛)     create())      
     тФВ              тФВ              тФВ                 тФВ
     тФВ              тФВ              тФВ                 тФВ
  ржкржгрзНржп ржирж┐рж░рзНржмрж╛ржЪржи тЖТ ржжрж╛ржо ржЧржгржирж╛ тФАтФАтЖТ рж░рзЗржХрж░рзНржб рж╕ржВрж░ржХрзНрж╖ржг тЖТ ржкрзНрж░рждрж┐ржЯрж┐
  ржПржмржВ ржкрж░рж┐ржорж╛ржг      ржПржмржВ ржЯрзНржпрж╛ржХрзНрж╕   ржХрж░рзБржи           ржкржгрзНржп
                                                    ржХржорж╛ржи
```

### ржбрж╛ржЯрж╛ ржлрзНрж▓рзЛ рзй: рж╕рзНржЯржХ ржЯрзНрж░рж╛ржирзНрж╕ржлрж╛рж░

```
ржЙрзОрж╕ ржорзНржпрж╛ржирзЗржЬрж╛рж░ тЖТ ржЯрзНрж░рж╛ржирзНрж╕ржлрж╛рж░ ржЕржирзБрж░рзЛржз тЖТ ржЧржирзНрждржмрзНржп ржЕржирзБржорзЛржжржи тЖТ рж╕рзНржЯржХ ржЖржкржбрзЗржЯ
   (ржврж╛ржХрж╛)        (stockTransfer)      (ржЪржЯрзНржЯржЧрзНрж░рж╛ржо)      (рж╕рзНржмржпрж╝ржВржХрзНрж░рж┐ржпрж╝)
     тФВ                тФВ                      тФВ               тФВ
     тФВ                тФВ                      тФВ               тФВ
  ржЯрзНрж░рж╛ржирзНрж╕ржлрж╛рж░  тФАтФАтЖТ ржкрзЗржирзНржбрж┐ржВ рж╕ржВрж░ржХрзНрж╖ржг тФАтФАтЖТ ржЕржирзБржорзЛржжржи ржХрж░рзБржи тФАтФАтЖТ ржЙрзОрж╕: -10
  ржЕржирзБрж░рзЛржз         ржХрж░рзБржи                  ржПржмржВ рж╕рзНржерж╛ржирж╛ржирзНрждрж░     ржЧржирзНрждржмрзНржп: +10
                                        рж╕ржорзНржкржирзНржи ржХрж░рзБржи
```

---

## ЁЯТ╛ ржбрж╛ржЯрж╛ржмрзЗрж╕ рж╕рзНржХрж┐ржорж╛ ржмрж┐рж╕рзНрждрж╛рж░рж┐ржд

### Branches ржЯрзЗржмрж┐рж▓

```typescript
{
  _id: Id<"branches">,
  name: string,              // "ржврж╛ржХрж╛ ржорзЗржЗржи рж╢рзЛрж░рзБржо"
  code: string,              // "BR-001" (ржЕржиржирзНржп)
  address: string,           // рж╕ржорзНржкрзВрж░рзНржг ржарж┐ржХрж╛ржирж╛
  city: string,              // "Dhaka"
  phone?: string,
  email?: string,
  managerId?: Id<"employees">,
  managerName?: string,
  isActive: boolean,         // true/false
  settings?: {
    allowNegativeStock: boolean,  // false = рж╕рзНржЯржХ рж╢рзЗрж╖ рж╣рж▓рзЗ ржмрж┐ржХрзНрж░ржпрж╝ ржмржирзНржз
    autoReorderLevel: number,     // 5 (ржХржо рж╕рзНржЯржХ рж╕рждрж░рзНржХрждрж╛рж░ рж╕рзНрждрж░)
    taxRate: number,              // 0.05 (5%)
    currency: string              // "BDT"
  },
  _creationTime: number
}

Index:
  - by_code: ржмрзНрж░рзНржпрж╛ржЮрзНржЪ ржХрзЛржб ржжрзНржмрж╛рж░рж╛ ржжрзНрж░рзБржд ржЕржирзБрж╕ржирзНржзрж╛ржи
  - by_city: рж╢рж╣рж░ ржжрзНржмрж╛рж░рж╛ ржлрж┐рж▓рзНржЯрж╛рж░ ржХрж░рзБржи
```

### Products ржЯрзЗржмрж┐рж▓

```typescript
{
  _id: Id<"products">,
  
  // ржорзМрж▓рж┐ржХ рждржерзНржп
  name: string,              // "ржкрзНрж░рж┐ржорж┐ржпрж╝рж╛ржо ржмрзНрж▓рзНржпрж╛ржХ ржЖржмрж╛ржпрж╝рж╛"
  brand: string,             // "Elegance Design"
  model?: string,            // "ED-2025-001"
  categoryId?: Id<"categories">,
  
  // ржкржгрзНржпрзЗрж░ ржмрзИрж╢рж┐рж╖рзНржЯрзНржп
  style?: string,            // "Traditional"
  fabric: string,            // "Crepe"
  color: string,             // "Black"
  sizes: string[],           // ["S", "M", "L", "XL", "XXL"]
  embellishments?: string,   // "Diamond stones"
  occasion?: string,         // "Formal"
  
  // ржорзВрж▓рзНржп ржирж┐рж░рзНржзрж╛рж░ржг
  costPrice: number,         // 1200
  sellingPrice: number,      // 2500
  
  // рж╕ржирж╛ржХрзНрждржХрж░ржг
  productCode: string,       // "PRD-001"
  barcode: string,           // "1234567890"
  pictureUrl?: string,
  
  // ржкрзНрж░рждрж┐ржЯрж┐ ржмрзНрж░рзНржпрж╛ржЮрзНржЪрзЗ рж╕рзНржЯржХ
  branchStock: [{
    branchId: Id<"branches">,
    branchName: string,
    currentStock: number,    // ржмрж░рзНрждржорж╛ржи ржкрж░рж┐ржорж╛ржг
    minStockLevel: number,   // ржкрзБржирж░рж╛ржпрж╝ ржЕрж░рзНржбрж╛рж░ ржкржпрж╝рзЗржирзНржЯ
    maxStockLevel: number    // рж╕рж░рзНржмрзЛржЪрзНржЪ рж╕рзНрждрж░
  }],
  
  // ржЧрзНрж▓рзЛржмрж╛рж▓ рж╕рзНржЯржХ
  currentStock: number,      // рж╕ржм ржмрзНрж░рзНржпрж╛ржЮрзНржЪрзЗрж░ ржпрзЛржЧржлрж▓
  minStockLevel: number,
  maxStockLevel: number,
  
  // ржЕржирзНржпрж╛ржирзНржп
  description?: string,
  isActive: boolean,         // true (рж╕ржХрзНрж░рж┐ржпрж╝) / false (ржирж┐рж╖рзНржХрзНрж░рж┐ржпрж╝)
  
  _creationTime: number
}

Indexes:
  - by_category: ржХрзНржпрж╛ржЯрж╛ржЧрж░рж┐ ржЕржирзБржпрж╛ржпрж╝рзА ржЕржирзБрж╕ржирзНржзрж╛ржи
  - by_brand: ржмрзНрж░рзНржпрж╛ржирзНржб ржЕржирзБржпрж╛ржпрж╝ ржЕржирзБрж╕ржирзНржзрж╛ржи
  - by_fabric, by_color, etc: ржлрж┐рж▓рзНржЯрж╛рж░рж┐ржВржпрж╝рзЗрж░ ржЬржирзНржп
  - search_products: ржкржгрзНржпрзЗрж░ ржирж╛ржо ржжрзНржмрж╛рж░рж╛ ржкрзВрж░рзНржг-ржкрж╛ржарзНржп ржЕржирзБрж╕ржирзНржзрж╛ржи
```

### StockMovements ржЯрзЗржмрж┐рж▓ (рж▓рзЗржиржжрзЗржи рж▓ржЧ)

```typescript
{
  _id: Id<"stockMovements">,
  productId: Id<"products">,
  productName: string,
  branchId: Id<"branches">,
  branchName: string,
  type: "in" | "out" | "transfer" | "adjustment",
  quantity: number,          // ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рж╛ ржкрж░рж┐ржорж╛ржг
  reason: string,            // "Sale", "Return", "Damage", "Transfer"
  reference?: string,        // ржмрж┐ржХрзНрж░ржпрж╝ рж╕ржВржЦрзНржпрж╛ ржмрж╛ ржЯрзНрж░рж╛ржирзНрж╕ржлрж╛рж░ ржиржорзНржмрж░
  fromBranchId?: Id<"branches">,  // ржЯрзНрж░рж╛ржирзНрж╕ржлрж╛рж░рзЗрж░ ржЬржирзНржп
  toBranchId?: Id<"branches">,
  userId: Id<"users">,
  userName: string,
  employeeId?: Id<"employees">,
  employeeName?: string,
  previousStock: number,
  newStock: number,
  notes?: string,
  _creationTime: number      // рж╕ржоржпрж╝ржорж╛ржи
}

Indexes:
  - by_product: ржкржгрзНржп ржжрзНржмрж╛рж░рж╛ рж╕ржорж╕рзНржд рж▓рзЗржиржжрзЗржи ржжрзЗржЦрзБржи
  - by_branch: ржмрзНрж░рзНржпрж╛ржЮрзНржЪ ржжрзНржмрж╛рж░рж╛ рж▓рзЗржиржжрзЗржи
  - by_type: ржзрж░ржи ржжрзНржмрж╛рж░рж╛ ржлрж┐рж▓рзНржЯрж╛рж░ ржХрж░рзБржи
```

### Sales ржЯрзЗржмрж┐рж▓

```typescript
{
  _id: Id<"sales">,
  saleNumber: string,        // "SAL-2025-001"
  branchId: Id<"branches">,
  branchName: string,
  customerId?: Id<"customers">,
  customerName?: string,
  
  items: [{
    productId: Id<"products">,
    productName: string,
    quantity: number,
    unitPrice: number,       // рж╕рзЗржЗ рж╕ржоржпрж╝рзЗрж░ ржжрж╛ржо
    totalPrice: number,
    size?: string,
    discountApplied?: {
      discountId: Id<"discounts">,
      discountName: string,
      discountValue: number,
      discountAmount: number
    }
  }],
  
  subtotal: number,          // ржорзЛржЯ ржжрж╛ржо (ржЫрж╛ржбрж╝ ржЖржЧрзЗ)
  tax: number,               // ржЯрзНржпрж╛ржХрзНрж╕ ржкрж░рж┐ржорж╛ржг
  discount: number,          // ржкрзНрж░ржпрж╝рзЛржЧржХрзГржд ржЫрж╛ржбрж╝
  total: number,             // ржЪрзВржбрж╝рж╛ржирзНржд ржжрж╛ржо
  paidAmount: number,        // ржЧрзНрж░рж╣ржгржХрзГржд
  dueAmount: number,         // ржмрж╛ржХрж┐ ржкрж░рж┐ржорж╛ржг
  paymentMethod: string,     // "cash" | "card" | "bKash"
  
  status: string,            // "completed" | "partial" | "pending"
  cashierId: Id<"users">,
  cashierName: string,
  employeeId?: Id<"employees">,  // ржмрж┐ржХрзНрж░ржпрж╝ рж╕рж╣рж╛ржпрж╝ржХ
  
  _creationTime: number
}

Indexes:
  - by_branch: ржмрзНрж░рзНржпрж╛ржЮрзНржЪ ржжрзНржмрж╛рж░рж╛ ржмрж┐ржХрзНрж░ржпрж╝
  - by_customer: ржЧрзНрж░рж╛рж╣ржХ ржжрзНржмрж╛рж░рж╛ ржмрж┐ржХрзНрж░ржпрж╝
  - by_status: ржЕржмрж╕рзНржерж╛ ржжрзНржмрж╛рж░рж╛ ржлрж┐рж▓рзНржЯрж╛рж░
```

### UserManagement ржЯрзЗржмрж┐рж▓

```typescript
{
  _id: Id<"userManagement">,
  userId: string,            // "USER-001"
  firstName: string,
  lastName: string,
  fullName: string,
  email: string,             // ржЕржиржирзНржп
  phone?: string,
  password: string,          // рж╣рзНржпрж╛рж╢ ржХрж░рж╛
  avatar?: string,
  roleId: Id<"userRoles">,
  roleName: string,          // "ржорзНржпрж╛ржирзЗржЬрж╛рж░", "ржХрзНржпрж╛рж╢рж┐ржпрж╝рж╛рж░"
  branchId?: Id<"branches">,
  branchName?: string,
  
  // ржЕржирзБржорждрж┐ ржкрждрж╛ржХрж╛
  isSuperAdmin: boolean,
  isAdmin: boolean,
  canManageUsers: boolean,
  canManageRoles: boolean,
  canAccessReports: boolean,
  canAccessSettings: boolean,
  
  // ржирж┐рж░рж╛ржкрждрзНрждрж╛
  status: string,            // "active" | "inactive" | "suspended"
  isLocked: boolean,
  loginAttempts: number,
  lastLogin?: number,
  
  joinDate: number,
  createdAt: number,
  updatedAt: number
}

Indexes:
  - by_email: ржжрзНрж░рзБржд ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржЦрзЛржБржЬрж╛
  - by_role: ржнрзВржорж┐ржХрж╛ ржжрзНржмрж╛рж░рж╛ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА
  - by_branch: рж╢рж╛ржЦрж╛ ржжрзНржмрж╛рж░рж╛ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА
```

---

## ЁЯФР ржЕржирзБржорждрж┐ рж╕рж┐рж╕рзНржЯрзЗржо

### ржХрзАржнрж╛ржмрзЗ ржЕржирзБржорждрж┐ ржХрж╛ржЬ ржХрж░рзЗ

```typescript
// userManagement рж╕рзНржХрж┐ржорж╛ржпрж╝ рж╕рж░рж╛рж╕рж░рж┐ ржлрзНрж▓рзНржпрж╛ржЧ
{
  isSuperAdmin: true/false       // рж╕ржм ржХрж┐ржЫрзБрж░ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕
  isAdmin: true/false            // ржкрзНрж░рж╢рж╛рж╕ржирж┐ржХ ржХрж╛ржЬ
  canManageUsers: true/false     // ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА рж╕рзГрж╖рзНржЯрж┐/рж╕ржорзНржкрж╛ржжржирж╛
  canManageRoles: true/false     // ржнрзВржорж┐ржХрж╛ рж╕ржВржЬрзНржЮрж╛ (рж╢рзБржзрзБ рж╕рзБржкрж╛рж░ ржЕрзНржпрж╛ржбржорж┐ржи)
  canAccessReports: true/false   // рж░рж┐ржкрзЛрж░рзНржЯ ржжрзЗржЦрж╛
  canAccessSettings: true/false  // рж╕рж┐рж╕рзНржЯрзЗржо рж╕рзЗржЯрж┐ржВрж╕
}
```

### ржмрзНрж░рзНржпрж╛ржЮрзНржЪ-рж╕рзНрждрж░рзЗрж░ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржирж┐ржпрж╝ржирзНрждрзНрж░ржг

```typescript
// ржмрзНрж░рзНржпрж╛ржЮрзНржЪ ржорзНржпрж╛ржирзЗржЬрж╛рж░ржжрзЗрж░ ржЬржирзНржп
// branchId рж░рзЗржХрж░рзНржб ржХрж░рж╛ рж╣ржпрж╝ userManagement ржП

// ржбрж╛ржЯрж╛ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржЪрзЗржХ ржХрж░рзБржи:
if (userBranchId !== recordBranchId) {
  throw new Error("ржПржЗ ржмрзНрж░рзНржпрж╛ржЮрзНржЪрзЗрж░ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржЕржирзБржорждрж┐ ржирзЗржЗ");
}

// рж╕рзБржкрж╛рж░ ржЕрзНржпрж╛ржбржорж┐ржи ржПржмржВ ржЕрзНржпрж╛ржбржорж┐ржи рж╕ржм ржмрзНрж░рзНржпрж╛ржЮрзНржЪ ржжрзЗржЦрждрзЗ ржкрж╛ржи
if (isSuperAdmin || isAdmin) {
  return allBranchData;
}

// ржЕржирзНржпрж░рж╛ рж╢рзБржзрзБ ржирж┐ржЬрзЗржжрзЗрж░ ржмрзНрж░рзНржпрж╛ржЮрзНржЪ ржжрзЗржЦрждрзЗ ржкрж╛ржи
return dataBranchData;
```

---

## ЁЯУЛ API ржПржирзНржбржкржпрж╝рзЗржирзНржЯ рж╕рзВржЪрзА

### Branches API

```typescript
// рж╕ржм ржмрзНрж░рзНржпрж╛ржЮрзНржЪ ржжрзЗржЦрзБржи
api.branches.list()
  тФЬтФА рж░рж┐ржЯрж╛рж░рзНржи: Branch[]
  тФФтФА ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕: рж╕ржм ржЕржирзБржорзЛржжрж┐ржд ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА

// ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржмрзНрж░рзНржпрж╛ржЮрзНржЪ
api.branches.get({ id: branchId })
  тФЬтФА рж░рж┐ржЯрж╛рж░рзНржи: Branch | null
  тФФтФА ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕: ржкрзНрж░рж╢рж╛рж╕ржХ ржмрж╛ ржУржЗ ржмрзНрж░рзНржпрж╛ржЮрзНржЪрзЗрж░ ржХрж░рзНржоржЪрж╛рж░рзА

// ржирждрзБржи ржмрзНрж░рзНржпрж╛ржЮрзНржЪ ржпрзЛржЧ ржХрж░рзБржи
api.branches.create({
  name: string,
  code: string,           // ржЕржиржирзНржп рж╣рждрзЗ рж╣ржмрзЗ
  address: string,
  city: string,
  phone?: string,
  email?: string,
  managerId?: Id,
  managerName?: string
})
  тФЬтФА рж░рж┐ржЯрж╛рж░рзНржи: branchId
  тФФтФА ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕: рж╕рзБржкрж╛рж░ ржЕрзНржпрж╛ржбржорж┐ржи, ржЕрзНржпрж╛ржбржорж┐ржи

// ржмрзНрж░рзНржпрж╛ржЮрзНржЪ рж╕ржорзНржкрж╛ржжржирж╛ ржХрж░рзБржи
api.branches.update({
  id: Id,
  name: string,
  code: string,
  address: string,
  city: string,
  phone?: string,
  email?: string,
  managerId?: Id,
  managerName?: string,
  isActive: boolean
})
  тФЬтФА рж░рж┐ржЯрж╛рж░рзНржи: branchId
  тФФтФА ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕: рж╕рзБржкрж╛рж░ ржЕрзНржпрж╛ржбржорж┐ржи, ржЕрзНржпрж╛ржбржорж┐ржи
```

### Products API

```typescript
// рж╕ржХрзНрж░рж┐ржпрж╝ ржкржгрзНржпрзЗрж░ рждрж╛рж▓рж┐ржХрж╛
api.products.list({
  categoryId?: Id,
  searchTerm?: string,
  brand?: string,
  style?: string,
  fabric?: string,
  color?: string,
  occasion?: string
})
  тФЬтФА рж░рж┐ржЯрж╛рж░рзНржи: Product[]
  тФФтФА ржлрж┐рж▓рзНржЯрж╛рж░ рж╕ржорж░рзНржержи ржХрж░рзЗ

// ржирждрзБржи ржкржгрзНржп ржпрзЛржЧ ржХрж░рзБржи
api.products.create({
  name: string,
  brand: string,
  categoryId?: Id,
  style?: string,
  fabric: string,
  color: string,
  sizes: string[],
  costPrice: number,
  sellingPrice: number,
  // ... ржЕржирзНржпрж╛ржирзНржп ржкржгрзНржп ржмрзИрж╢рж┐рж╖рзНржЯрзНржп
  // branchStock ржП ржкрзНрж░рж╛ржержорж┐ржХ рж╕рзНржЯржХ
})
  тФЬтФА рж░рж┐ржЯрж╛рж░рзНржи: productId
  тФФтФА ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕: ржЕрзНржпрж╛ржбржорж┐ржи, ржмрзНрж░рзНржпрж╛ржЮрзНржЪ ржорзНржпрж╛ржирзЗржЬрж╛рж░

// ржкржгрзНржп рж╕ржорзНржкрж╛ржжржирж╛ ржХрж░рзБржи
api.products.update({
  id: Id,
  // ... ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рж╛ ржлрж┐рж▓рзНржб
})
  тФЬтФА рж░рж┐ржЯрж╛рж░рзНржи: productId
  тФФтФА ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕: ржкржгрзНржпрзЗрж░ ржорж╛рж▓рж┐ржХ рж╢рж╛ржЦрж╛рж░ ржорзНржпрж╛ржирзЗржЬрж╛рж░
```

### StockManagement API

```typescript
// ржмрзНрж░рзНржпрж╛ржЮрзНржЪ ржЗржиржнрзЗржирзНржЯрж░рж┐ ржкрж╛ржи
api.stockManagement.getBranchInventory({
  branchId: Id
})
  тФЬтФА рж░рж┐ржЯрж╛рж░рзНржи: {
  тФВ   productId, productName, currentStock,
  тФВ   minStockLevel, maxStockLevel, status
  тФВ }[]
  тФФтФА ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕: ржмрзНрж░рзНржпрж╛ржЮрзНржЪ ржорзНржпрж╛ржирзЗржЬрж╛рж░, ржЗржиржнрзЗржирзНржЯрж░рж┐ ржорзНржпрж╛ржирзЗржЬрж╛рж░

// рж╕рзНржЯржХ рж╕рж╛ржоржЮрзНржЬрж╕рзНржп ржХрж░рзБржи
api.stockManagement.adjustStock({
  productId: Id,
  branchId: Id,
  quantity: number,
  type: "add" | "deduct" | "adjustment",
  reason: string  // ржмрж░рзНржгржирж╛
})
  тФЬтФА рж╕рзНржмржпрж╝ржВржХрзНрж░рж┐ржпрж╝ржнрж╛ржмрзЗ: рж▓рзЗржиржжрзЗржи рж▓ржЧ рждрзИрж░рж┐ ржХрж░рзЗ
  тФФтФА ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕: ржЗржиржнрзЗржирзНржЯрж░рж┐ ржорзНржпрж╛ржирзЗржЬрж╛рж░, ржмрзНрж░рзНржпрж╛ржЮрзНржЪ ржорзНржпрж╛ржирзЗржЬрж╛рж░

// ржХржо рж╕рзНржЯржХ ржЖржЗржЯрзЗржо ржкрж╛ржи
api.stockManagement.getLowStockItems({
  branchId?: Id  // ржРржЪрзНржЫрж┐ржХ - рж╕ржм ржмрзНрж░рзНржпрж╛ржЮрзНржЪ ржпржжрж┐ ржЦрж╛рж▓рж┐
})
  тФЬтФА рж░рж┐ржЯрж╛рж░рзНржи: {
  тФВ   productId, productName, currentStock,
  тФВ   minStockLevel, shortage
  тФВ }[]
  тФФтФА ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕: рж╕ржм ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ржпрзЛржЧрзНржп ржмрзНрж░рзНржпрж╛ржЮрзНржЪ
```

---

## ЁЯОп ржиржорзБржирж╛ ржмрж╛рж╕рзНрждржмрж╛ржпрж╝ржи

### ржирждрзБржи ржмрзНрж░рзНржпрж╛ржЮрзНржЪ рж╕рзЗржЯржЖржк ржХрзЛржб

```typescript
// 1. ржмрзНрж░рзНржпрж╛ржЮрзНржЪ рждрзИрж░рж┐ ржХрж░рзБржи
const branchId = await createBranch({
  name: "ржврж╛ржХрж╛ ржорзЗржЗржи рж╢рзЛрж░рзБржо",
  code: "BR-DHA-01",
  address: "123 ржиржЬрж░рзБрж▓ рж╕ржбрж╝ржХ, ржврж╛ржХрж╛",
  city: "Dhaka",
  phone: "02-555-0001",
  email: "dhaka@company.com"
});

// 2. ржорзНржпрж╛ржирзЗржЬрж╛рж░ ржирж┐ржпрж╝рзЛржЧ ржХрж░рзБржи
const managerId = await createEmployee({
  employeeId: "EMP-001",
  name: "рж░рж╣рж┐ржо ржЖрж╣ржорзЗржж",
  email: "rahim@company.com",
  phone: "01612345678",
  position: "Manager",
  branchId: branchId,
  permissions: [
    "sales_management",
    "inventory_management",
    "customer_management",
    "reports_access",
    "outstanding_management"
  ]
});

// 3. ржорзНржпрж╛ржирзЗржЬрж╛рж░ ржмрзНрж░рзНржпрж╛ржЮрзНржЪрзЗ ржпрзБржХрзНржд ржХрж░рзБржи
await updateBranch({
  id: branchId,
  managerId: managerId,
  managerName: "рж░рж╣рж┐ржо ржЖрж╣ржорзЗржж"
});

// 4. ржкржгрзНржпрзЗ ржкрзНрж░рж╛ржержорж┐ржХ рж╕рзНржЯржХ ржпрзЛржЧ ржХрж░рзБржи
const productId = await createProduct({
  name: "ржкрзНрж░рж┐ржорж┐ржпрж╝рж╛ржо ржмрзНрж▓рзНржпрж╛ржХ ржЖржмрж╛ржпрж╝рж╛",
  brand: "Elegance",
  fabric: "Crepe",
  color: "Black",
  sizes: ["S", "M", "L", "XL"],
  costPrice: 1200,
  sellingPrice: 2500,
  branchStock: [
    {
      branchId: branchId,
      branchName: "ржврж╛ржХрж╛ ржорзЗржЗржи",
      currentStock: 50,
      minStockLevel: 10,
      maxStockLevel: 100
    }
  ]
});
```

### рж╕рзНржЯржХ рж╕ржоржирзНржмржпрж╝ ржХрзЛржб

```typescript
// рж╕рзНржЯржХ ржпрзЛржЧ ржХрж░рзБржи (ржирждрзБржи рж╕рж░ржмрж░рж╛рж╣)
await adjustStock({
  productId: productId,
  branchId: branchId,
  quantity: 20,
  type: "add",
  reason: "ржирждрзБржи рж╕рж░ржмрж░рж╛рж╣ - ржХрзНрж░ржпрж╝ ржЕрж░рзНржбрж╛рж░ #PO-001"
});

// рж╕рзНржЯржХ ржХржорж╛ржи (ржмрж┐ржХрзНрж░ржпрж╝)
await adjustStock({
  productId: productId,
  branchId: branchId,
  quantity: 5,
  type: "deduct",
  reason: "ржмрж┐ржХрзНрж░ржпрж╝ - рж╕ржорзНржкрзВрж░рзНржг рж╕ржВржЦрзНржпрж╛ SAL-2025-001"
});

// рж╕рзНржЯржХ рж╕ржоржирзНржмржпрж╝ (рждрзНрж░рзБржЯрж┐ рж╕ржВрж╢рзЛржзржи)
await adjustStock({
  productId: productId,
  branchId: branchId,
  quantity: 47,  // рж╕ржарж┐ржХ рж╕ржВржЦрзНржпрж╛
  type: "adjustment",
  reason: "рж╢рж╛рж░рзАрж░рж┐ржХ ржЗржиржнрзЗржирзНржЯрж░рж┐ ржЕржбрж┐ржЯ - ржЧржгржирж╛ рж╕ржоржирзНржмржпрж╝"
});
```

---

## ЁЯЪА ржмрж╛рж╕рзНрждржмрж╛ржпрж╝ржирзЗрж░ ржЕржЧрзНрж░рж╛ржзрж┐ржХрж╛рж░

### тЬЕ рж╕ржорзНржкржирзНржи

```
тЬУ Branches ржкрж░рж┐ржЪрж╛рж▓ржирж╛ (рждрзИрж░рж┐, рж╕ржорзНржкрж╛ржжржирж╛, ржжрзЗржЦрж╛)
тЬУ Products ржкрж░рж┐ржЪрж╛рж▓ржирж╛ (рждрзИрж░рж┐, рж╕ржорзНржкрж╛ржжржирж╛)
тЬУ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржПржмржВ ржнрзВржорж┐ржХрж╛ рж╕рж┐рж╕рзНржЯрзЗржо
тЬУ ржкрзНрж░рждрж┐-ржмрзНрж░рзНржпрж╛ржЮрзНржЪ ржЗржиржнрзЗржирзНржЯрж░рж┐ ржЯрзНрж░рзНржпрж╛ржХрж┐ржВ
тЬУ рж╕рзНржЯржХ рж╕ржоржирзНржмржпрж╝ ржПржмржВ рж▓рзЗржиржжрзЗржи рж▓ржЧрж┐ржВ
тЬУ ржХржо рж╕рзНржЯржХ рж╕рждрж░рзНржХрждрж╛
тЬУ ржмрж┐ржХрзНрж░ржпрж╝ рж░рзЗржХрж░рзНржбрж┐ржВ
```

### ЁЯЯб ржЖржВрж╢рж┐ржХ ржЕржержмрж╛ ржЙржирзНржирждрж┐ ржкрзНрж░ржпрж╝рзЛржЬржи

```
тЪая╕П рж╕рзНржЯржХ ржЯрзНрж░рж╛ржирзНрж╕ржлрж╛рж░ ржЕржирзБржорзЛржжржи ржкрзНрж░ржмрж╛рж╣
  ржХрж░рждрзЗ рж╣ржмрзЗ:
  - рж╕рзНржЯржХ ржЯрзНрж░рж╛ржирзНрж╕ржлрж╛рж░ ржЕржирзБрж░рзЛржз ржкрзВрж░рзНржг UI
  - ржЙрзОрж╕ тЖТ ржЧржирзНрждржмрзНржп ржЕржирзБржорзЛржжржи ржкрзНрж░ржмрж╛рж╣
  - рж╕рзНржмржпрж╝ржВржХрзНрж░рж┐ржпрж╝ рж╕рзНржЯржХ ржЖржкржбрзЗржЯ

тЪая╕П ржорж╛рж▓рзНржЯрж┐-ржмрзНрж░рзНржпрж╛ржЮрзНржЪ рж░рж┐ржкрзЛрж░рзНржЯрж┐ржВ
  ржХрж░рждрзЗ рж╣ржмрзЗ:
  - рждрзБрж▓ржирж╛ржорзВрж▓ржХ ржмрж┐ржХрзНрж░ржпрж╝ ржЪрж╛рж░рзНржЯ
  - ржмрзНрж░рзНржпрж╛ржЮрзНржЪ ржХрж░рзНржоржХрзНрж╖ржорждрж╛ ржорзЗржЯрзНрж░рж┐ржХрзНрж╕
  - ржЗржиржнрзЗржирзНржЯрж░рж┐ рж╕рзНржмрж╛рж╕рзНржерзНржп ржбрзНржпрж╛рж╢ржмрзЛрж░рзНржб

тЪая╕П рж░рж┐ржЯрж╛рж░рзНржи ржПржмржВ ржмрж┐ржирж┐ржоржпрж╝ ржкрзНрж░рж╕рзЗрж╕
  ржХрж░рждрзЗ рж╣ржмрзЗ:
  - рж░рж┐ржЯрж╛рж░рзНржи ржЕржирзБрж░рзЛржз ржлрж░рзНржо
  - ржЕржирзБржорзЛржжржи ржУржпрж╝рж╛рж░рзНржХржлрзНрж▓рзЛ
  - рж░рж┐ржлрж╛ржирзНржб ржкрзНрж░ржХрзНрж░рж┐ржпрж╝рж╛ржХрж░ржг
  - ржЗржиржнрзЗржирзНржЯрж░рж┐ ржЖржкржбрзЗржЯ
```

### тЭМ ржПржЦржирзЛ рж╢рзБрж░рзБ рж╣ржпрж╝ржирж┐

```
тЬЧ рж╕рзНржмржпрж╝ржВржХрзНрж░рж┐ржпрж╝ ржкрзБржирж░рж╛ржпрж╝ ржЕрж░рзНржбрж╛рж░ ржкрж░рж╛ржорж░рзНрж╢
тЬЧ ржмрж┐ржХрзНрж░ржпрж╝ ржкрзВрж░рзНржмрж╛ржнрж╛рж╕ ржПржмржВ ржЯрзНрж░рзЗржирзНржб ржмрж┐рж╢рзНрж▓рзЗрж╖ржг
тЬЧ ржЗржиржнрзЗржирзНржЯрж░рж┐ ржЦрж░ржЪ ржмрж┐рж╢рзНрж▓рзЗрж╖ржг
тЬЧ ржорзЛржмрж╛ржЗрж▓ ржЕрзНржпрж╛ржк
тЬЧ ржмрж╛рж░ржХрзЛржб рж╕рзНржХрзЗржирж╛рж░ ржЗржирзНржЯрж┐ржЧрзНрж░рзЗрж╢ржи
```

---

## ЁЯУЭ ржбрж┐ржмрж╛ржЧрж┐ржВ ржирж┐рж░рзНржжрзЗрж╢рж╛ржмрж▓рзА

### рж╕ржорж╕рзНржпрж╛: ржмрзНрж░рзНржпрж╛ржЮрзНржЪ ржорзНржпрж╛ржирзЗржЬрж╛рж░ ржЕржирзНржп ржмрзНрж░рзНржпрж╛ржЮрзНржЪрзЗрж░ ржбрж╛ржЯрж╛ ржжрзЗржЦрждрзЗ ржкрж╛ржЪрзНржЫрзЗ

```typescript
// рж╕ржорж╕рзНржпрж╛: branchId ржЪрзЗржХ ржЕржирзБржкрж▓ржмрзНржз

// рж╕ржорж╛ржзрж╛ржи: ржкрзНрж░рждрж┐ржЯрж┐ query/mutation ржП ржпрзЛржЧ ржХрж░рзБржи
const userBranch = user.branchId;
if (userBranch !== requestedBranchId && !user.isSuperAdmin) {
  throw new Error("ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржЕржирзБржорждрж┐ ржирзЗржЗ");
}
```

### рж╕ржорж╕рзНржпрж╛: рж╕рзНржЯржХ рж╕рж╛ржоржЮрзНржЬрж╕рзНржп ржмрж╛рж░рзНрждрж╛ ржкрж╛ржЪрзНржЫрж┐ ржирж╛

```typescript
// ржирж┐рж╢рзНржЪрж┐ржд ржХрж░рзБржи: branchStock ржЕрзНржпрж╛рж░рзЗ рж╕ржарж┐ржХ рж░рзВржкрзЗ ржЖржкржбрзЗржЯ рж╣ржЪрзНржЫрзЗ
const product = await db.get(productId);
const updated = product.branchStock.map((bs) => {
  if (bs.branchId === updatingBranchId) {
    return { ...bs, currentStock: newQuantity };
  }
  return bs;
});

// ржЧрзНрж▓рзЛржмрж╛рж▓ рж╕рзНржЯржХ ржЖржкржбрзЗржЯ ржХрж░рзБржи
const totalStock = updated.reduce((sum, bs) => sum + bs.currentStock, 0);
```

---

## ЁЯФН ржкрж░рзАржХрзНрж╖рж╛ ржЪрзЗржХрж▓рж┐рж╕рзНржЯ

```
[ ] ржмрзНрж░рзНржпрж╛ржЮрзНржЪ рждрзИрж░рж┐ ржХрж░рзБржи ржПржмржВ ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рзБржи
[ ] ржкржгрзНржп ржпрзЛржЧ ржХрж░рзБржи рж╕рж╣ рж╢рж╛ржЦрж╛-рж╕рзНржЯржХ рж╕рзЗржЯржЖржк
[ ] рж╕рзНржЯржХ рж╕рж╛ржоржЮрзНржЬрж╕рзНржп ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рзБржи (ржпрзЛржЧ, ржХржорж╛ржи, рж╕ржоржирзНржмржпрж╝)
[ ] ржкрзВрж░рзНржг ржЧржгржирж╛: ржмрж┐ржнрж┐ржирзНржи ржмрзНрж░рзНржпрж╛ржЮрзНржЪрзЗ ржПржХржЗ ржкржгрзНржп
[ ] ржмрж┐ржХрзНрж░ржпрж╝ рж░рзЗржХрж░рзНржб ржХрж░рзБржи ржПржмржВ рж╕рзНржЯржХ ржЖржкржбрзЗржЯ ржпрж╛ржЪрж╛ржЗ ржХрж░рзБржи
[ ] ржмрзНрж░рзНржпрж╛ржЮрзНржЪ ржорзНржпрж╛ржирзЗржЬрж╛рж░ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржирж┐ржпрж╝ржирзНрждрзНрж░ржг ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рзБржи
[ ] ржХржо рж╕рзНржЯржХ рж╕рждрж░рзНржХрждрж╛ ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рзБржи
[ ] рж▓рзЗржиржжрзЗржи рж▓ржЧ рж╕ржарж┐ржХржнрж╛ржмрзЗ рж░рзЗржХрж░рзНржб рж╣ржЪрзНржЫрзЗ ржХрж┐ржирж╛ ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рзБржи
[ ] ржмрзНрж░рзНржпрж╛ржЮрзНржЪ-рж╕рзНрждрж░рзЗрж░ рж░рж┐ржкрзЛрж░рзНржЯ ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рзБржи
```

---

**ржЖржкржирж╛рж░ рж╕рж┐рж╕рзНржЯрзЗржо ржкрзНрж░ржпрзБржХрзНрждрж┐ржЧрждржнрж╛ржмрзЗ рж╢ржХрзНрждрж┐рж╢рж╛рж▓рзА ржПржмржВ ржкрзНрж░рж╕рзНрждрзБржд! ЁЯЪА**
